---
title: –ü—Ä–æ—Ç–æ–∫–æ–ª–∏
parent: Python
nav_order: 6
layout: default
---

<!-- @formatter:off -->
# –ü—Ä–æ—Ç–æ–∫–æ–ª–∏
- TOC
{:toc}
<!-- @formatter:on -->

## –ó–∞–≥–∞–ª—å–Ω–µ

### –©–æ —Ç–∞–∫–µ –ø—Ä–æ—Ç–æ–∫–æ–ª —É Python?

<hr>

**–ü—Ä–æ—Ç–æ–∫–æ–ª (protocol)** ‚Äî —Ü–µ –Ω–∞–±—ñ—Ä –º–µ—Ç–æ–¥—ñ–≤ —Ç–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, —è–∫—ñ –æ–±‚Äô—î–∫—Ç –ø–æ–≤–∏–Ω–µ–Ω —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏, —â–æ–±
–≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –¥–µ—è–∫–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É. –¢–æ–±—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª –≤–∏–∑–Ω–∞—á–∞—î ¬´–∫–æ–Ω—Ç—Ä–∞–∫—Ç¬ª –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –æ–±‚Äô—î–∫—Ç–∞ –±–µ–∑
—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –∫–ª–∞—Å–∏.

### –©–æ —Ç–∞–∫–µ subtyping —É Python?

<hr>

**–£—Å–ø–∞–¥–∫—É–≤–∞–Ω–Ω—è —Ç–∏–ø—É (subtyping)** ‚Äî —Ü–µ –ø—Ä–∏–Ω—Ü–∏–ø –æ–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —è–∫–∏–π –æ–∑–Ω–∞—á–∞—î,
—â–æ –æ–¥–∏–Ω —Ç–∏–ø (–∫–ª–∞—Å) –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏–π —è–∫ –ø—ñ–¥—Ç–∏–ø —ñ–Ω—à–æ–≥–æ —Ç–∏–ø—É (–∫–ª–∞—Å—É), —Ç–æ–±—Ç–æ –æ–±‚Äô—î–∫—Ç–∏ –ø—ñ–¥—Ç–∏–ø—É
–º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è —Ç–∞–º, –¥–µ –æ—á—ñ–∫—É—î—Ç—å—Å—è –±–∞–∑–æ–≤–∏–π —Ç–∏–ø.

–£ Python subtyping –º–∞—î –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ñ —Ä—ñ–∑–Ω–æ–≤–∏–¥–∏: –Ω–æ–º—ñ–Ω–∞–ª—å–Ω–µ —ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–µ.

**Nominal subtyping**: –ø—ñ–¥—Ç–∏–ø –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ —è–≤–Ω–µ —É—Å–ø–∞–¥–∫—É–≤–∞–Ω–Ω—è –∫–ª–∞—Å—ñ–≤.

<!-- @formatter:off -->
```python
class Animal:
    pass

class Dog(Animal):  # Dog ‚Äî –ø—ñ–¥—Ç–∏–ø Animal
    pass

a: Animal = Dog()  # –∫–æ—Ä–µ–∫—Ç–Ω–æ
```
<!-- @formatter:on -->

–¢—É—Ç `Dog` —î –ø—ñ–¥—Ç–∏–ø–æ–º `Animal`, –±–æ —è–≤–Ω–æ —É—Å–ø–∞–¥–∫–æ–≤—É—î –π–æ–≥–æ.

**Structural subtyping**: –ø—ñ–¥—Ç–∏–ø –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –Ω–µ —ñ–º‚Äô—è–º –∫–ª–∞—Å—É, –∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—é –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –∞–±–æ
–∞—Ç—Ä–∏–±—É—Ç—ñ–≤. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è _duck typing_ —ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ (`Protocol`) –∑ –º–æ–¥—É–ª—è `typing`.

<!-- @formatter:off -->
```python
from typing import Protocol

class Quackable(Protocol):
    def quack(self) -> None:
        ...

class Duck:
    def quack(self) -> None:
        print("Quack!")

def make_it_quack(q: Quackable):
    q.quack()

make_it_quack(Duck())  # Duck —Ä–µ–∞–ª—ñ–∑—É—î –ø—Ä–æ—Ç–æ–∫–æ–ª ‚Üí –ø—Ä–∞—Ü—é—î
```
<!-- @formatter:off -->

–¢—É—Ç `Duck` –Ω–µ —É—Å–ø–∞–¥–∫–æ–≤—É—î `Quackable`, –∞–ª–µ –≤—Å–µ –æ–¥–Ω–æ —Å—É–º—ñ—Å–Ω–∏–π —ñ–∑ –π–æ–≥–æ ¬´—Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é¬ª ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏–π
–ø—ñ–¥—Ç–∏–ø.

## Iterators —Ç–∞ Iterables

### –©–æ —Ç–∞–∫–µ `Iterable` —É Python?

<hr>

**Iterable** ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç, —â–æ –º—ñ—Å—Ç–∏—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ –≤ —Ü–∏–∫–ª—ñ `for` –∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —á–µ—Ä–µ–∑
—Ñ—É–Ω–∫—Ü—ñ—é `iter()`. –°–ø–∏—Å–∫–∏, –∫–æ—Ä—Ç–µ–∂—ñ, —Å–ª–æ–≤–Ω–∏–∫–∏ —Ç–∞ –º–Ω–æ–∂–∏–Ω–∏ —î _iterable_. –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:

* –ú–∞—î –º–µ—Ç–æ–¥ `__iter__()`, —è–∫–∏–π –ø–æ–≤–µ—Ä—Ç–∞—î —ñ—Ç–µ—Ä–∞—Ç–æ—Ä.
* –ú–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ–¥–∞–Ω–∏–π —É –±—É–¥—å-—è–∫—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é, —â–æ –ø–µ—Ä–µ–±–∏—Ä–∞—î –µ–ª–µ–º–µ–Ω—Ç–∏ (`for`, `list()`, `tuple()`,
  `sum()` —Ç–æ—â–æ).
* Iterable –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Ä–∞–∑—ñ–≤ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö iterator-—ñ–≤.

<!-- @formatter:off -->
```python
class Iterable:
    def __init__(self, sequence):
        self.sequence = sequence

    def __iter__(self):
        return SequenceIterator(self.sequence)

for value in Iterable([1, 2, 3, 4]):
    print(value)  # 1 2 3 4 
```
<!-- @formatter:on -->

### –©–æ —Ç–∞–∫–µ `Iterator` —É Python?

<hr>

**Iterator** ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç, —è–∫–∏–π –¥–∞—î –∑–º–æ–≥—É –ø–æ –æ–¥–Ω–æ–º—É –ø–µ—Ä–µ–±–∏—Ä–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –≤ —Ü–∏–∫–ª–∞—Ö —Ç–∞
—ñ–Ω—à–∏—Ö –≤–∏—Ä–∞–∑–∞—Ö. –ö–ª—é—á–æ–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:

* –ú–∞—î –¥–≤–∞ –º–µ—Ç–æ–¥–∏:
    * `__iter__()` –ø–æ–≤–µ—Ä—Ç–∞—î —Å–∞–º iterator (`self`)
    * `__next__()` –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –∞–±–æ –≤–∏–∫–ª–∏–∫–∞—î `StopIteration`, —è–∫—â–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –±—ñ–ª—å—à–µ
      –Ω–µ–º–∞—î.
* Iterator –º–æ–∂–Ω–∞ **–æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –±—É–¥—å-—è–∫–æ–≥–æ iterable** —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—é `iter()`.
* –ü—ñ—Å–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ iterator **–≤–∏—á–µ—Ä–ø—É—î—Ç—å—Å—è**.
* **–õ—ñ–Ω–∏–≤–∞ (lazy) –æ–±—Ä–æ–±–∫–∞**: iterator –Ω–µ —Å—Ç–≤–æ—Ä—é—î –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤—ñ–¥—Ä–∞–∑—É, —â–æ –µ–∫–æ–Ω–æ–º–∏—Ç—å –ø–∞–º‚Äô—è—Ç—å
  (–æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ñ–≤ —á–∏ –≤–µ–ª–∏–∫–∏—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π).

–Ü—Ç–µ—Ä–∞—Ç–æ—Ä –≤—ñ–¥–æ–∫—Ä–µ–º–ª—é—î –ª–æ–≥—ñ–∫—É –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤—ñ–¥ –ª–æ–≥—ñ–∫–∏ —ó—Ö –æ–±—Ö–æ–¥—É.

–ó–∞–≥–∞–ª–æ–º –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç—Ä–∏ —Ä—ñ–∑–Ω–æ–≤–∏–¥–∏ —ñ—Ç–µ—Ä–∞—Ç–æ—Ä—ñ–≤:

1. –Ü—Ç–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î –¥–∞–Ω—ñ –π –ø–æ–≤–µ—Ä—Ç–∞—î —ó—Ö –≤ —Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ, —è–∫–æ–º—É –≤–æ–Ω–∏ —î.
    ```python
    class SequenceIterator:
        def __init__(self, sequence):
            self._sequence = sequence
            self._index = 0
    
        def __iter__(self):
            return self
    
        def __next__(self):
            if self._index < len(self._sequence):
                item = self._sequence[self._index]
                self._index += 1
                return item
            else:
                raise StopIteration

   for item in SequenceIterator([1, 2, 3, 4]):
        print(item) # 1 2 3 4
    ```
2. –Ü—Ç–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î –¥–∞–Ω—ñ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–æ–≤–∞–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏.

    ```python
    class SquareIterator:
        def __init__(self, sequence):
            self._sequence = sequence
            self._index = 0
    
        def __iter__(self):
            return self
    
        def __next__(self):
            if self._index < len(self._sequence):
                square = self._sequence[self._index] ** 2
                self._index += 1
                return square
            else:
                raise StopIteration
    
        for square in SquareIterator([1, 2, 3, 4, 5]):
            print(square)  # 1 4 9 16 25
    ```

3. –Ü—Ç–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –Ω–µ –ø—Ä–∏–π–º–∞—î –¥–∞–Ω—ñ, –∞ –≥–µ–Ω–µ—Ä—É—î –π –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–æ–≤—ñ.

    ```python
    class FibonacciIterator:
        def __init__(self, stop=10):
            self._stop = stop
            self._index = 0
            self._current = 0
            self._next = 1
    
        def __iter__(self):
            return self
    
        def __next__(self):
            if self._index < self._stop:
                self._index += 1
                number = self._current
                self._current, self._next = self._next, self._current + self._next
                return number
            else:
                raise StopIteration
    
    for fib_number in FibonacciIterator():
        print(fib_number)  # 0 1 1 2 3 5 8 13 21 34
    ```

### –ó–∞ —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ñ—É–Ω–∫—Ü—ñ—è `next()` —É Python?

<hr>

**–§—É–Ω–∫—Ü—ñ—è `next()`** —É Python –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —ñ—Ç–µ—Ä–∞—Ç–æ—Ä–∞. –í–æ–Ω–∞
–≤–∏–∫–ª–∏–∫–∞—î –º–µ—Ç–æ–¥ `__next__()` —É –æ–±‚Äô—î–∫—Ç–∞-—ñ—Ç–µ—Ä–∞—Ç–æ—Ä–∞.

```python
next(iterator[, default])
```

* –Ø–∫—â–æ –µ–ª–µ–º–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π ‚Üí –ø–æ–≤–µ—Ä—Ç–∞—î –π–æ–≥–æ.
* –Ø–∫—â–æ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑–∞–∫—ñ–Ω—á–∏–ª–∏—Å—è ‚Üí –≤–∏–∫–∏–¥–∞—î –≤–∏–Ω—è—Ç–æ–∫ `StopIteration`.

## Generators

### –©–æ —Ç–∞–∫–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É Python?

<hr>

**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä (generator)** ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Ç–∏–ø —ñ—Ç–µ—Ä–∞—Ç–æ—Ä–∞, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è "–Ω–∞
–≤–∏–º–æ–≥—É" –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤—Å—é –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —É –ø–∞–º‚Äô—è—Ç—ñ. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –∞–±–æ –∑–∞
–¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ–π –∑ –∫–ª—é—á–æ–≤–∏–º —Å–ª–æ–≤–æ–º `yield`, –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤** (generator
expressions).
–ö–ª—é—á–æ–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:

* **–õ—ñ–Ω–∏–≤–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è:** –∑–Ω–∞—á–µ–Ω–Ω—è –æ–±—á–∏—Å–ª—é—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —Ç–æ–¥—ñ, –∫–æ–ª–∏ –≤–æ–Ω–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ, —â–æ –µ–∫–æ–Ω–æ–º–∏—Ç—å
  –ø–∞–º‚Äô—è—Ç—å.
* –ö–æ–ª–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `yield`, —Ñ—É–Ω–∫—Ü—ñ—è –∑—É–ø–∏–Ω—è—î—Ç—å—Å—è —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è, –∞ –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤–∏–∫–ª–∏–∫—É
  **–ø—Ä–æ–¥–æ–≤–∂—É—î –∑ —Ç–æ–≥–æ –∂ –º—ñ—Å—Ü—è**.
* **–Ü—Ç–µ—Ä–∞—Ç–æ—Ä:** –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —É —Ü–∏–∫–ª–∞—Ö `for` –∞–±–æ —Ñ—É–Ω–∫—Ü—ñ—è—Ö, —â–æ –ø—Ä–∏–π–º–∞—é—Ç—å —ñ—Ç–µ—Ä–∞—Ç–æ—Ä–∏
  (`sum`, `list`, `next` —ñ —Ç.–¥.).
* –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è **–≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤** –¥–∞–Ω–∏—Ö –∞–±–æ **–Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π**.

<!-- @formatter:off -->
```python
def fibonacci_generator(stop=10):
    current_fib, next_fib = 0, 1
    for _ in range(0, stop):
        fib_number = current_fib
        current_fib, next_fib = next_fib, current_fib + next_fib
        yield fib_number

list(fibonacci_generator())  # [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
```
<!-- @formatter:on -->

–¢—É—Ç –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ü–∏–∫–ª—É, —Ñ—É–Ω–∫—Ü—ñ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª–∏—á–µ `StopIteration`.

–î–ª—è —è–≤–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è, –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `return` —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ.

```python
def fibonacci_generator(stop=10):
    current_fib, next_fib = 0, 1
    index = 0
    while True:
        if index == stop:
            return
        index += 1
        fib_number = current_fib
        current_fib, next_fib = next_fib, current_fib + next_fib
        yield fib_number
```

### Iterator vs. Iterable vs. Generator

<hr>

**Iterable** ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç, —â–æ –º—ñ—Å—Ç–∏—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ –≤ —Ü–∏–∫–ª—ñ `for` –∞–±–æ
–æ—Ç—Ä–∏–º–∞—Ç–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—é `iter()`, —â–æ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π —ñ—Ç–µ—Ä–∞—Ç–æ—Ä. –°–∞–º –ø–æ —Å–æ–±—ñ iterable –Ω–µ ‚Äú–ø–∞–º‚Äô—è—Ç–∞—î‚Äù, –Ω–∞
—è–∫–æ–º—É –µ–ª–µ–º–µ–Ω—Ç—ñ –∑—É–ø–∏–Ω–∏–≤—Å—è.

* –†–µ–∞–ª—ñ–∑—É—î –º–µ—Ç–æ–¥ `__iter__()`
* –ü—Ä–∏–∫–ª–∞–¥–∏: `list`, `tuple`, `str`, `dict`, `set`

**–Ü—Ç–µ—Ä–∞—Ç–æ—Ä (iterator)** ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç, —è–∫–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ø–æ—Ç—ñ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, –ø–æ —è–∫–∏—Ö –º–æ–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏—Å—å –æ–¥–∏–Ω
—Ä–∞–∑. –í—ñ–Ω "–ø–∞–º‚Äô—è—Ç–∞—î" —Å–≤—ñ–π –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –ø—ñ–¥ —á–∞—Å —ñ—Ç–µ—Ä–∞—Ü—ñ—ó. –ö–æ–ª–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è, –≤–∏–∫–ª–∏–∫–∞—î
`StopIteration`.

* –†–µ–∞–ª—ñ–∑—É—î –º–µ—Ç–æ–¥–∏ `__iter__()` —Ç–∞ `__next__()`

**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä (generator)** ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Ç–∏–ø —ñ—Ç–µ—Ä–∞—Ç–æ—Ä–∞, —è–∫–∏–π —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é
—Ñ—É–Ω–∫—Ü—ñ–π —ñ–∑ `yield`, –∞–±–æ —á–µ—Ä–µ–∑ **–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏**. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è
–ª—ñ–Ω–∏–≤–æ (lazy evaluation), —Ç–æ–±—Ç–æ –ø–æ –æ–¥–Ω–æ–º—É, –±–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—î—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –≤ –ø–∞–º‚Äô—è—Ç—å.

### –©–æ —Ç–∞–∫–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏ (generator expressions)?

<hr>

**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏ (generator expressions)** - —Ü–µ —Å–∫–æ—Ä–æ—á–µ–Ω–∏–π —Å–ø–æ—Å—ñ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –±–µ–∑
–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–∫—Ä–µ–º–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –∑ `yield`. –í–æ–Ω–∏ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –º–∞–π–∂–µ —è–∫ —Å–ø–∏—Å–∫–æ–≤—ñ –≤–∏—Ä–∞–∑–∏ (list
comprehensions), –∞–ª–µ –∑–∞–º—ñ—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏—Ö –¥—É–∂–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –∫—Ä—É–≥–ª—ñ.

```python
# –°–ø–∏—Å–∫–æ–≤–µ –≤–∫–ª—é—á–µ–Ω–Ω—è ‚Äì —Å—Ç–≤–æ—Ä—é—î –æ–¥—Ä–∞–∑—É —Å–ø–∏—Å–æ–∫ —É –ø–∞–º‚Äô—è—Ç—ñ
squares_list = [x * x for x in range(5)]

# –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–Ω–∏–π –≤–∏—Ä–∞–∑ ‚Äì —Å—Ç–≤–æ—Ä—é—î –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (–ª—ñ–Ω–∏–≤–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è)
squares_gen = (x * x for x in range(5))

print(squares_list)  # [0, 1, 4, 9, 16]
print(next(squares_gen))  # 0
print(next(squares_gen))  # 1
```

### –©–æ —Ç–∞–∫–µ `yield from` —ñ —è–∫ –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å?

<hr>

`yield from` ‚Äî —Ü–µ —Å–∫–æ—Ä–æ—á–µ–Ω–∏–π —Å–ø–æ—Å—ñ–± –¥–µ–ª–µ–≥—É–≤–∞—Ç–∏ —á–∞—Å—Ç–∏–Ω—É —Ä–æ–±–æ—Ç–∏ —ñ–Ω—à–æ–º—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É –∞–±–æ –±—É–¥—å-—è–∫–æ–º—É
—ñ—Ç–µ—Ä–∞–±–µ–ª—å–Ω–æ–º—É –æ–±‚Äô—î–∫—Ç—É. –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –ø–∏—Å–∞—Ç–∏ —Ü–∏–∫–ª —ñ–∑ `yield` –≤—Ä—É—á–Ω—É, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏  
`yield from`.

<!-- @formatter:off -->
```python
def subgen():
    yield 1
    yield 2
    yield 3

def main():
    yield 0
    yield from subgen()  # –¥–µ–ª–µ–≥—É—î –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É subgen
    yield 4

print(list(main()))  # [0, 1, 2, 3, 4]
```
<!-- @formatter:on -->

–¢—É—Ç `main()` –Ω–µ –ø–∏—à–µ —Ü–∏–∫–ª `for val in subgen(): yield val`, –∞ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `yield from`.

### –ß–∏ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤?

<hr>

**–ù—ñ.** –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏ –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑, –±–æ –≤—ñ–Ω "—Å–ø–æ–∂–∏–≤–∞—î" –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Å—Ç—É–ø–æ–≤–æ. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ
–ø–æ–≤—Ç–æ—Ä–Ω—ñ –æ–±—Ö–æ–¥–∏, —Ç—Ä–µ–±–∞ –∞–±–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞–Ω—ñ –≤ –∫–æ–ª–µ–∫—Ü—ñ—é, –∞–±–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π
—ñ—Ç–µ—Ä–∞—Ü—ñ—ó.

<!-- @formatter:off -->
```python
def gen():
    yield 1
    yield 2
    yield 3

g = gen()

print(list(g))  # [1, 2, 3]
print(list(g))  # []

for _ in range(2):
    for val in gen():  # –≤–∏–∫–ª–∏–∫ gen() —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
        print(val)  # [1, 2, 3]
```
<!-- @formatter:on -->

### –ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –º–µ—Ç–æ–¥–∏ `send()`, `throw()` —ñ `close()`?

* `send(value)` –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –≤ —Ç–æ—á–∫—É, –¥–µ –≤—ñ–Ω –∑–∞—Ä–∞–∑ ‚Äú–∑–∞–≤–∏—Å‚Äù –Ω–∞
  `yield`. –ó–∞–∑–≤–∏—á–∞–π `yield` –ø–æ–≤–µ—Ä—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–∑–æ–≤–Ω—ñ, –∞–ª–µ –∑ `send()` –≤—ñ–Ω —â–µ –π –ø—Ä–∏–π–º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è
  –Ω–∞–∑–∞–¥. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –∫–æ—Ä—É—Ç–∏–Ω–∞—Ö (–¥–æ –ø–æ—è–≤–∏ `async/await`).

    ```python
    def gen():
        x = yield "–ü–æ—á–∞—Ç–æ–∫"
        yield f"–û—Ç—Ä–∏–º–∞–≤: {x}"
    
    g = gen()
    print(next(g))        # "–ü–æ—á–∞—Ç–æ–∫"
    print(g.send("Hello"))  # "–û—Ç—Ä–∏–º–∞–≤: Hello"
    ```

* `throw(exc_type, exc_value=None, traceback=None)` –¥–æ–∑–≤–æ–ª—è—î –≤–∫–∏–Ω—É—Ç–∏ –≤–∏–Ω—è—Ç–æ–∫ —É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É —Ç–æ—á–∫—É,
  –¥–µ –≤—ñ–Ω –∑—É–ø–∏–Ω–∏–≤—Å—è –Ω–∞ `yield`. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ —Ü–µ–π –≤–∏–Ω—è—Ç–æ–∫ —á–µ—Ä–µ–∑ `try/except`. –Ø–∫—â–æ –Ω–µ
  –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ ‚Üí –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è.

  ```python
  def gen():
      try:
          yield 1
      except ValueError:
          yield "–û–±—Ä–æ–±–∏–≤ ValueError"
  
  g = gen()
  print(next(g))  # 1
  print(g.throw(ValueError))  # "–û–±—Ä–æ–±–∏–≤ ValueError"
  ```

* `close()` –≤–∏–∫–ª–∏–∫–∞—î –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞. –í—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤–∏–Ω—è—Ç–æ–∫ `GeneratorExit`.
  –ó—Ä—É—á–Ω–æ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–∫—Ä–∏—Ç—Ç—è —Ñ–∞–π–ª—É –∞–±–æ —Å–µ—Å—ñ—ó).

  ```python
  def gen():
      try:
          yield 1
      finally:
          print("–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–∫—Ä–∏—Ç–æ")
  
  g = gen()
  print(next(g))  # 1
  g.close()  # "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–∫—Ä–∏—Ç–æ"
  ```

## Context Managers

### –©–æ —Ç–∞–∫–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä —É Python?

<hr>

**–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä (context manager)** ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±–ª–æ–∫—É
–∫–æ–¥—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó `with`. –í—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ç–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è —Ä–µ—Å—É—Ä—Å—ñ–≤
(—Ñ–∞–π–ª–∏, —Å–æ–∫–µ—Ç–∏, –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –ë–î —Ç–æ—â–æ).

–Ñ –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ñ —Å–ø–æ—Å–æ–±–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Å–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ ‚Äî –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª–∞—Å—É –∞–±–æ —á–µ—Ä–µ–∑
–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@contextmanager` –∑ –º–æ–¥—É–ª—è `contextlib`. –ü–µ—Ä—à–∏–π –¥–∞—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –¥—Ä—É–≥–∏–π ‚Äî –±—ñ–ª—å—à
–ª–∞–∫–æ–Ω—ñ—á–Ω–∏–π –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤.

–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –¥–≤–∞ –º–µ—Ç–æ–¥–∏:

* `__enter__()` ‚Äì –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –Ω–∞ –ø–æ—á–∞—Ç–∫—É –±–ª–æ–∫—É `with`. –ü–æ–≤–µ—Ä—Ç–∞—î —Ä–µ—Å—É—Ä—Å.
* `__exit__(exc_type, exc_value, traceback)` ‚Äì –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤ –∫—ñ–Ω—Ü—ñ –±–ª–æ–∫—É, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å—Ç–∞–ª–∞—Å—è
  –ø–æ–º–∏–ª–∫–∞. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—Ä–∏–±–∏—Ä–∞–Ω–Ω—è (–∑–∞–∫—Ä–∏—Ç—Ç—è —Ñ–∞–π–ª—ñ–≤, –∑‚Äô—î–¥–Ω–∞–Ω—å —ñ —Ç.–¥.).

<!-- @formatter:off -->
```python
from contextlib import contextmanager

@contextmanager
def my_context():
    print("üîπ –í—Ö–æ–¥–∏–º–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç")
    yield "resource"  # —Ç—É—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω–∞ —Ä–æ–±–æ—Ç–∞
    print("üî∏ –í–∏—Ö–æ–¥–∏–º–æ –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É")

with my_context() as res:
    print("–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ:", res)
```
<!-- @formatter:on -->

### –ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –º–µ–Ω–µ–¥–∂–µ—Ä–∏?

<hr>

–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –º–µ–Ω–µ–¥–∂–µ—Ä–∏ —É Python –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è **–≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏**. –í–æ–Ω–∏
–∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—é—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è/–∑–∞–∫—Ä–∏—Ç—Ç—è, –±–ª–æ–∫—É–≤–∞–Ω–Ω—è/—Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è —á–∏ —Å—Ç–∞—Ä—Ç/—Ñ—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—é –æ–ø–µ—Ä–∞—Ü—ñ–π, —â–æ–±
—É–Ω–∏–∫–∞—Ç–∏ –≤–∏—Ç–æ–∫—ñ–≤ –ø–∞–º‚Äô—è—Ç—ñ –π –ø–æ–º–∏–ª–æ–∫.

–û—Å–Ω–æ–≤–Ω—ñ –∑–∞–¥–∞—á—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤:

1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ **–∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤** (—Ñ–∞–π–ª–∏ (`open`), —Å–æ–∫–µ—Ç–∏, –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –ë–î, –º–µ—Ä–µ–∂–µ–≤—ñ –∑–∞–ø–∏—Ç–∏).
2. –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–µ **–ø—Ä–∏–±–∏—Ä–∞–Ω–Ω—è** –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö. –ö–æ–¥ —É `__exit__` –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è –∑–∞–≤–∂–¥–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ
   –≤ –±–ª–æ—Ü—ñ `with` —Å—Ç–∞–ª–∞—Å—è –≤–∏–Ω—è—Ç–∫–æ–≤–∞ —Å–∏—Ç—É–∞—Ü—ñ—è.
3. –ß–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å —ñ —á–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥—É: –∑–∞–º—ñ—Å—Ç—å `try/finally`, –∫–æ–¥ —É `with` –≤–∏–≥–ª—è–¥–∞—î –ª–∞–∫–æ–Ω—ñ—á–Ω–æ.

### –Ø–∫—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤ —î —É Python?

<hr>

1. –†–æ–±–æ—Ç–∞ –∑ —Ñ–∞–π–ª–∞–º–∏: `open()`
    ```python
      with open("data.txt", "w") as f:
          f.write("hello")
    ```

2. –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è (`threading.Lock`):
    ```python
    import threading
    
    lock = threading.Lock()
    with lock:
        # –∫—Ä–∏—Ç–∏—á–Ω–∞ —Å–µ–∫—Ü—ñ—è
        print("–†–æ–±–æ—Ç–∞ –∑ —Ä–µ—Å—É—Ä—Å–æ–º")
    ```

3. –¢–∏–º—á–∞—Å–æ–≤–∞ –∑–º—ñ–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ç–æ—á–Ω–æ—Å—Ç—ñ –æ–±—á–∏—Å–ª–µ–Ω—å `decimal.localcontext()`:
    ```python
    from decimal import Decimal, localcontext
    
    with localcontext() as ctx:
        ctx.prec = 4
        print(Decimal("1") / Decimal("7"))  # 0.1429
    ```

### –Ø–∫ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –≤–∏–Ω—è—Ç–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –±–ª–æ–∫—É `with`?

<hr>

1. –ö–æ–ª–∏ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–ª–æ–∫ `with`, Python –≤–∏–∫–ª–∏–∫–∞—î –º–µ—Ç–æ–¥ `__enter__()` –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞.
2. –ü–æ—Ç—ñ–º –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∫–æ–¥ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –±–ª–æ–∫—É `with`.
3. –Ø–∫—â–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –±–ª–æ–∫—É –≤–∏–Ω–∏–∫–∞—î –≤–∏–Ω—è—Ç–æ–∫, Python –Ω–µ –≤–∏–∫–∏–¥–∞—î –π–æ–≥–æ –æ–¥—Ä–∞–∑—É.
4. –ó–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –º–µ—Ç–æ–¥ `__exit__(exc_type, exc_value, traceback)`:
    * `exc_type` ‚Äî —Ç–∏–ø –≤–∏–Ω—è—Ç–∫—É
    * `exc_value` ‚Äî –æ–±‚Äô—î–∫—Ç –≤–∏–Ω—è—Ç–∫—É
    * `traceback` ‚Äî —Ç—Ä–∞—Å—É–≤–∞–Ω–Ω—è
5. –ü–æ–≤–µ—Ä—Ç–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –∑ `__exit__`:
    * –Ø–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è `True`, –≤–∏–Ω—è—Ç–æ–∫ —ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è —ñ –±–ª–æ–∫ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–∫–∏.
    * –Ø–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è `False` –∞–±–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è, –≤–∏–Ω—è—Ç–æ–∫ –ø–µ—Ä–µ–∫–∏–¥–∞—î—Ç—å—Å—è –¥–∞–ª—ñ –ø—ñ—Å–ª—è
      –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è `__exit__`.

### –©–æ —Ç–∞–∫–µ –≤–∏—Ç—ñ–∫ –ø–∞–º'—è—Ç—ñ?

<hr>

**–í–∏—Ç—ñ–∫ –ø–∞–º‚Äô—è—Ç—ñ (memory leak)** ‚Äî —Ü–µ —Å–∏—Ç—É–∞—Ü—ñ—è, –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∏–¥—ñ–ª—è—î –ø–∞–º‚Äô—è—Ç—å, –∞–ª–µ –Ω–µ –∑–≤—ñ–ª—å–Ω—è—î —ó—ó,
–Ω–∞–≤—ñ—Ç—å –∫–æ–ª–∏ –≤–æ–Ω–∞ –≤–∂–µ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞.

Python –º–∞—î –∞–≤—Ç–æ–º–∞—Ç–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—Ç—é —á–µ—Ä–µ–∑ GC (garbage collector) + –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø–æ—Å–∏–ª–∞–Ω—å.
–¢–æ–º—É –∫–ª–∞—Å–∏—á–Ω—ñ ‚Äú–≤–∏—Ç–æ–∫–∏‚Äù (—è–∫ —É C) —Ç—Ä–∞–ø–ª—è—é—Ç—å—Å—è —Ä—ñ–¥—à–µ, –∞–ª–µ –º–æ–∂–ª–∏–≤—ñ –ª–æ–≥—ñ—á–Ω—ñ –≤–∏—Ç–æ–∫–∏ –ø–∞–º‚Äô—è—Ç—ñ: –∫–æ–ª–∏
–æ–±‚Äô—î–∫—Ç–∏ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ —á–µ—Ä–µ–∑ —è–∫—ñ—Å—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è, —ñ GC —ó—Ö –Ω–µ –º–æ–∂–µ –ø—Ä–∏–±—Ä–∞—Ç–∏ (–Ω–µ–∑–∞–∫—Ä–∏—Ç—ñ —Ä–µ—Å—É—Ä—Å–∏,
–Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω—ñ –∫–æ–ª–µ–∫—Ü—ñ—ó, –∫—Ä—É–≥–æ–≤—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —á–∏ –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ).

### –£ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ 'try/finally' —Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ ('with') —É Python?

<hr>

`try/finally` —ñ `with` –≤–∏—Ä—ñ—à—É—é—Ç—å —Å—Ö–æ–∂—É –∑–∞–¥–∞—á—É ‚Äî –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–µ –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –ø—ñ–¥ —á–∞—Å
—Ä–æ–±–æ—Ç–∏ –≤–∏–Ω–∏–∫–∞—é—Ç—å –≤–∏–Ω—è—Ç–∫–∏. –ê–ª–µ –º—ñ–∂ –Ω–∏–º–∏ —î –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤–∞ —Ä—ñ–∑–Ω–∏—Ü—è —É —Å—Ç–∏–ª—ñ —Ç–∞ –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.

* `try/finally` ‚Äî —Ü–µ –±–∞–∑–æ–≤–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞—Ç–∏ cleanup-–æ–ø–µ—Ä–∞—Ü—ñ—ó –≤—Ä—É—á–Ω—É.
    ```python
    f = open("data.txt", "w")
    try:
        f.write("hello")
    finally:
        f.close()
    ```

* `with` (–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä) ‚Äî —Ü–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–∏–π —Ü—É–∫–æ—Ä –ø–æ–≤–µ—Ä—Ö `try/finally`. –û–±‚Äô—î–∫—Ç, —è–∫–∏–π
  –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É `with`, —Ä–µ–∞–ª—ñ–∑—É—î –ø—Ä–æ—Ç–æ–∫–æ–ª –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (`__enter__`, `__exit__`), —ñ Python
  —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–∫–æ–Ω—É—î cleanup.
    ```python
    with open("data.txt", "w") as f:
        f.write("hello")
    ```

### –©–æ —Ç–∞–∫–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä?

<hr>

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä** ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ async with.
–í—ñ–Ω —Ä–µ–∞–ª—ñ–∑—É—î –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, —Ç–æ–±—Ç–æ –∑–∞–º—ñ—Å—Ç—å –∑–≤–∏—á–∞–π–Ω–∏—Ö `__enter__` / `__exit__` –º–∞—î:

* `__aenter__(self)` ‚Äî –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –≤—Ö–æ–¥—ñ –≤ –±–ª–æ–∫ `async with` (–ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ `async def` –∞–±–æ
  –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ `awaitable`).
* `__aexit__(self, exc_type, exc, tb)` ‚Äî –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ (—Ç–µ–∂ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π)

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –º–µ–Ω–µ–¥–∂–µ—Ä–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏, —è–∫—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å
await. –¢–∏–ø–æ–≤—ñ –ø—Ä–∏–∫–ª–∞–¥–∏: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ HTTP-–∑‚Äô—î–¥–Ω–∞–Ω–Ω—è (`aiohttp`), WebSocket-–∏, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
(`asyncio.Lock`), —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó —É –ë–î.

## Sequences —Ç–∞ Mappings

### –©–æ —Ç–∞–∫–µ `Sequence` —É Python?

<hr>

**Sequence (–ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å)** ‚Äî —Ü–µ –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ—è —É Python –¥–ª—è –≤–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, –¥–æ —è–∫–∏—Ö
–º–æ–∂–Ω–∞ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –ø–æ —ñ–Ω–¥–µ–∫—Å—É —ñ —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å —ñ—Ç–µ—Ä–∞—Ü—ñ—é.

–ü—Ä–∏–∫–ª–∞–¥–∏ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö sequence:

* –ó–º—ñ–Ω–Ω—ñ (mutable): `list`, `bytearray`
* –ù–µ–∑–º—ñ–Ω–Ω—ñ (immutable): `tuple`, `str`, `bytes`, `range`

–£—Å—ñ —Ç–∏–ø–∏, —â–æ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å sequence protocol, –º–∞—é—Ç—å:

* `__getitem__(self, index)` ‚Äî –¥–æ—Å—Ç—É–ø –¥–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑–∞ —ñ–Ω–¥–µ–∫—Å–æ–º,
* `__len__(self)` ‚Äî –¥–æ–≤–∂–∏–Ω–∞.

–û–∫—Ä—ñ–º —Ü–∏—Ö –¥–≤–æ—Ö –º–µ—Ç–æ–¥—ñ–≤, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –∑–∞–∑–≤–∏—á–∞–π —Ä–µ–∞–ª—ñ–∑–æ–≤—É—é—Ç—å `__iter__()`.

–ö–ª—é—á–æ–≤—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π:

* **–í–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω—ñ—Å—Ç—å** ‚Äî –µ–ª–µ–º–µ–Ω—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –ø–µ–≤–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É (–Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ `set` —á–∏ `dict`).
* **–Ü–Ω–¥–µ–∫—Å–∞—Ü—ñ—è** ‚Äî –º–æ–∂–Ω–∞ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑–∞ —ñ–Ω–¥–µ–∫—Å–æ–º `seq[i]`.
* **–°–ª–∞–π—Å–∏** ‚Äî –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –∑—Ä—ñ–∑–∏: `seq[start:end:step]`.
* **–Ü—Ç–µ—Ä–∞—Ü—ñ—è** ‚Äî –º–æ–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏—Å—å —Ü–∏–∫–ª–æ–º `for`.
* –û–ø–µ—Ä–∞—Ü—ñ—ó:
    * –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è: `"ab" + "cd"` ‚Üí `abcd`
    * –ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è: `[1, 2] * 3` ‚Üí `[1, 2, 1, 2, 1, 2]`
    * –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ: `x in seq`.
    * –õ–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ—ñ—á–Ω–µ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å: –µ–ª–µ–º–µ–Ω—Ç–∏ –π–¥—É—Ç—å –∑–ª—ñ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ, —ñ –ø–µ—Ä—à–∞ —Ä—ñ–∑–Ω–∏—Ü—è –≤–∏–∑–Ω–∞—á–∞—î
      —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –Ø–∫—â–æ –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —Ä—ñ–≤–Ω—ñ, –∞–ª–µ –¥–æ–≤–∂–∏–Ω–∏ —Ä—ñ–∑–Ω—ñ ‚Äî –∫–æ—Ä–æ—Ç—à–∞ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –º–µ–Ω—à–æ—é. –Ø–∫—â–æ –≤—Å—ñ
      –µ–ª–µ–º–µ–Ω—Ç–∏ –π –¥–æ–≤–∂–∏–Ω–∞ —Ä—ñ–≤–Ω—ñ ‚Äî –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —Ä—ñ–≤–Ω—ñ.

### –î–ª—è —á–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –∫–ª–∞—Å `collections.abc.Sequence`?

<hr>

–£ Python `collections.abc.Sequence` ‚Äî —Ü–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π –±–∞–∑–æ–≤–∏–π –∫–ª–∞—Å (ABC), —è–∫–∏–π –æ–ø–∏—Å—É—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ.

–©–æ–± –∫–ª–∞—Å –≤–≤–∞–∂–∞–≤—Å—è –ø—ñ–¥–∫–ª–∞—Å–æ–º `Sequence`, –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏: `__getitem__(self, index)` —ñ `__len__
(self)`.

–Ü —Ç–æ–¥—ñ –≤—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º–∞—î –≤—ñ–¥ Sequence —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞–∫–∏—Ö –º–µ—Ç–æ–¥—ñ–≤, —è–∫:

* `__contains__` (`in`)
* `__iter__`
* `__reversed__`
* `index()`
* `count()`

–ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω?

1. –§–æ—Ä–º–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∏–ø—ñ–≤
2. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—è API

### –ß–∏–º –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è `Sequence` –≤—ñ–¥ `MutableSequence` —É Python?

<hr>

–£ Python `collections.abc.Sequence` ‚Äî —Ü–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π –±–∞–∑–æ–≤–∏–π –∫–ª–∞—Å (ABC), —è–∫–∏–π –æ–ø–∏—Å—É—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è. –í—ñ–Ω –≤–∏–º–∞–≥–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ª–∏—à–µ –¥–≤–æ—Ö –º–µ—Ç–æ–¥—ñ–≤: `__getitem__` —ñ `__len__`.
–Ü–Ω—à—ñ –º–µ—Ç–æ–¥–∏, —Ç–∞–∫—ñ —è–∫ `__contains__`, `__iter__`, `count` —Ç–∞ `index`, –Ω–∞–¥–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.
–ö–ª–∞—Å-–Ω–∞—â–∞–¥–æ–∫, —â–æ –Ω–∞—Å–ª—ñ–¥—É—î `Sequence`, —Ñ–∞–∫—Ç–∏—á–Ω–æ —î immutable –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É API: –µ–ª–µ–º–µ–Ω—Ç–∏ –º–æ–∂–Ω–∞
—Ç—ñ–ª—å–∫–∏ —á–∏—Ç–∞—Ç–∏, –∞–ª–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –¥–ª—è –∑–º—ñ–Ω–∏ (`append`, `pop`, `__setitem__`) –≤—ñ–Ω –Ω–µ –º–∞—î.

–©–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ mutable –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å, –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞—Å–ª—ñ–¥—É–≤–∞—Ç–∏—Å—è –≤—ñ–¥ `collections.abc.MutableSequence`.
–¶–µ–π –∫–ª–∞—Å —Ä–æ–∑—à–∏—Ä—é—î `Sequence` —ñ –¥–æ–¥–∞—î –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó: `__setitem__`,
`__delitem__`, `insert()`. –ü—ñ—Å–ª—è —ó—Ö —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º—É—î—Ç–µ —Ç–∞–∫—ñ –º–µ—Ç–æ–¥–∏, —è–∫ `append`,
`remove`, `pop` —Ç–∞ `reverse`.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ –º–µ—Ç–∞ ‚Äî –º–∞—Ç–∏ –∑–º—ñ–Ω–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è –≤—ñ–¥ `Sequence` –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ.
–ù–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `MutableSequence` —ñ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –∑–º—ñ–Ω–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.

<!-- @formatter:off -->
```python
from collections.abc import MutableSequence

class MyList(MutableSequence):
    def __init__(self, data=None):
        self._data = list(data) if data else []

    def __getitem__(self, index):
        return self._data[index]

    def __setitem__(self, index, value):
        self._data[index] = value

    def __delitem__(self, index):
        del self._data[index]

    def __len__(self):
        return len(self._data)

    def insert(self, index, value):
        self._data.insert(index, value)

ml = MyList([1, 2, 3])
ml[0] = 10
ml.append(4)
print(list(ml))  # [10, 2, 3, 4]
```
<!-- @formatter:on -->

### –©–æ —Ç–∞–∫–µ `Mapping` —É Python?

<hr>

**Mapping** ‚Äî —Ü–µ –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω–∞ –∫–æ–ª–µ–∫—Ü—ñ—è, —è–∫–∞ –∑–±–µ—Ä—ñ–≥–∞—î –ø–∞—Ä–∏ –∫–ª—é—á ‚Üí –∑–Ω–∞—á–µ–Ω–Ω—è.

–ö–ª—é—á–æ–≤—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –º–∞–ø:

1. **–î–æ—Å—Ç—É–ø –∑–∞ –∫–ª—é—á–µ–º:** –∑–Ω–∞—á–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –Ω–µ –∑–∞ –ø–æ–∑–∏—Ü—ñ—î—é, –∞ –∑–∞ –∫–ª—é—á–µ–º.
2. –ö–æ–∂–µ–Ω –∫–ª—é—á —É –º–∞–ø—ñ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ **—É–Ω—ñ–∫–∞–ª—å–Ω–∏–º**. –Ø–∫—â–æ –¥–æ–¥–∞—Ç–∏ –∫–ª—é—á, —â–æ –≤–∂–µ —ñ—Å–Ω—É—î, –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è
   –æ–Ω–æ–≤–∏—Ç—å—Å—è.
3. –†–∞–Ω—ñ—à–µ –ø–æ—Ä—è–¥–æ–∫ –∫–ª—é—á—ñ–≤ –Ω–µ –≥–∞—Ä–∞–Ω—Ç—É–≤–∞–≤—Å—è. –ü–æ—á–∏–Ω–∞—é—á–∏ –∑ Python 3.7, `dict` –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ—Ä—è–¥–æ–∫ –≤—Å—Ç–∞–≤–∫–∏
   –∫–ª—é—á—ñ–≤.

Python –Ω–∞–¥–∞—î `collections.abc.Mapping` ‚Äî –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π –±–∞–∑–æ–≤–∏–π –∫–ª–∞—Å –¥–ª—è –≤—Å—ñ—Ö –º–∞–ø. –©–æ–± –≤–≤–∞–∂–∞—Ç–∏—Å—è
–º–∞–ø–æ—é, –∫–ª–∞—Å –ø–æ–≤–∏–Ω–µ–Ω —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏:

* `__getitem__(self, key)`
* `__iter__(self)` (—ñ—Ç–µ—Ä–∞—Ü—ñ—è –ø–æ –∫–ª—é—á–∞—Ö)
* `__len__(self)`

–Ü–Ω—à—ñ –º–µ—Ç–æ–¥–∏ (`keys()`, `items()`, `values()`, `get()`) –Ω–∞–¥–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.

### –ß–∏–º –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è `Mapping` –≤—ñ–¥ `MutableMapping` —É Python?

–£ Python `Mapping` —ñ `MutableMapping` ‚Äî —Ü–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ñ –±–∞–∑–æ–≤—ñ –∫–ª–∞—Å–∏ (ABCs) –¥–ª—è —Å–ª–æ–≤–Ω–∏–∫–æ–ø–æ–¥—ñ–±–Ω–∏—Ö
–æ–±‚Äô—î–∫—Ç—ñ–≤, –∞–ª–µ –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ä—ñ–≤–Ω—è–º–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö.

`Mapping` ‚Äî —Ü–µ immutable –º–∞–ø–∞, —Ç–æ–±—Ç–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–∏—à–µ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è. –í–∏–º–∞–≥–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç—Ä—å–æ—Ö –±–∞–∑–æ–≤–∏—Ö
–º–µ—Ç–æ–¥—ñ–≤: `__getitem__(self, key)`, `__iter__(self)` —ñ `__len__(self)`. –Ü–Ω—à—ñ –º–µ—Ç–æ–¥–∏ (`keys()`,
`items()`,
`values()`, `get()`) –Ω–∞–¥–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å, –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –∫–æ–ª–µ–∫—Ü—ñ—è –¥–æ–∑–≤–æ–ª—è–ª–∞ —Ç—ñ–ª—å–∫–∏
–¥–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö, –±–µ–∑ –∑–º—ñ–Ω.

`MutableMapping` ‚Äî —Ü–µ mutable –º–∞–ø–∞, —Ç–æ–±—Ç–æ –º–∞–ø–∞, –¥–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏.
–û–∫—Ä—ñ–º –º–µ—Ç–æ–¥—ñ–≤ `Mapping`, –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏:

* `__setitem__(self, key, value)` ‚Äî –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —á–∏ –∑–º—ñ–Ω–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
* `__delitem__(self, key)` ‚Äî –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤

–Ü–Ω—à—ñ –º–µ—Ç–æ–¥–∏ (`pop`, `update`, `clear`) –Ω–∞–¥–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Å–ª–æ–≤–Ω–∏–∫–æ–ø–æ–¥—ñ–±–Ω—ñ –æ–±‚Äô—î–∫—Ç–∏ –∑ –ø–æ–≤–Ω–æ—é –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.